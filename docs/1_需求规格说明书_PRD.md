# 产品需求规格说明书 (PRD)

**项目名称**: Re:Aniname  
**版本**: 1.0  
**状态**: 规划中  
**最后更新日期**: 2026-02-04

---

## 1. 项目背景与目标

### 1.1 背景

随着 NAS (Network Attached Storage) 的普及，越来越多的用户开始搭建个人媒体服务器（如 Emby, Plex, Jellyfin）。然而，从 BT 站点下载的动漫/剧集资源文件名通常极其不规范，包含大量无关信息，导致媒体服务器无法正确刮削元数据。

### 1.2 目标

开发一款**现代化**的自动化工具，采用前后端分离架构，能够智能识别本地下载的动漫/电影文件，将其重命名并整理为符合 TMDB/Emby 标准的目录结构。

### 1.3 核心价值

- **标准化**: 将混乱的文件名转换为 `SxxExx` 标准格式。
- **自动化**: 对接下载软件（qBittorrent），实现下载即整理。
- **智能化**: 引入 AI (LLM) 解决传统正则无法处理的复杂映射。
- **现代化体验**: 采用 Next.js + Material Design 构建美观、流畅的用户界面。

---

## 2. 用户角色 (User Personas)

| 角色             | 描述             | 核心诉求                               |
| :--------------- | :--------------- | :------------------------------------- |
| **NAS 进阶玩家** | 拥有大量动漫库存 | 高性能，支持 Docker 部署，低资源占用   |
| **颜值党**       | 重视软件 UI/UX   | 界面现代美观，操作流畅，Dark Mode 支持 |
| **开发者**       | 喜欢折腾二次开发 | 代码结构清晰，TypeScript 强类型支持    |

---

## 3. 功能需求 (Functional Requirements)

### 3.1 核心重命名功能 (Core Renaming)

- **R-001 文件名清洗**: 基于 Node.js 的高性能字符串处理，去除标签、分辨率等干扰字符。
- **R-002 类型识别**: 智能区分“剧集 (TV)”与“电影 (Movie)”。
- **R-003 元数据匹配**:
  - 调用 TMDB API 获取官方剧集信息。
  - 支持 Jikan API (MyAnimeList) 备选。
- **R-004 目录整理**:
  - 电影结构: `电影名 (年份)/电影名 (年份).ext`
  - 剧集结构: `剧集名 (年份)/Season X/SXXEXX - 标题.ext`
- **R-005 文件操作模式**:
  - 支持 **硬链接 (Hard Link)** (Node.js `fs.link`).
  - 支持 复制/移动。

### 3.2 AI 智能增强 (AI Powered)

- **AI-001 复杂映射分析**: 调用 OpenAI/Gemini SDK 分析文件列表。
- **AI-002 智能归类**: 处理 SP、OVA、总集篇映射。
- **AI-003 置信度评估**: 提供 High/Medium/Low 评级。

### 3.3 Web 管理界面 (Next.js UI)

- **UI-001 现代化仪表盘**: 使用 Material UI (MUI) 组件库构建。
- **UI-002 任务管理**: 异步任务提交与进度追踪。
- **UI-003 配置中心**:
  - 响应式表单设计。
  - 实时校验 API Key 有效性。
- **UI-004 实时日志**: 基于 Socket.io 的日志流推送。

### 3.4 自动化集成

- **INT-001 RESTful API**: 提供标准的 REST 接口供外部调用。

---

## 4. 技术栈 (Tech Stack)

| 领域      | 技术              | 说明                                               |
| :-------- | :---------------- | :------------------------------------------------- |
| **前端**  | Next.js (React)   | App Router 架构，SSR/CSR 混合渲染                  |
| **UI 库** | Material UI (MUI) | Google Material Design 设计语言                    |
| **后端**  | Node.js           | 高性能异步 I/O                                     |
| **框架**  | Express / NestJS  | 稳健的服务端框架 (本项目采用 Express + TypeScript) |
| **语言**  | TypeScript        | 全栈强类型支持                                     |
| **通信**  | Socket.io         | 实时日志推送                                       |

---

## 5. 待办事项与未来规划 (Roadmap)

- [ ] 适配移动端 Web 访问。
- [ ] 支持多语言 (i18n)。
- [ ] 增加用户账户系统。
